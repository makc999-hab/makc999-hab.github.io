<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å - StudyAI</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
    <link rel="stylesheet" href="style.css">
    <style>
        .profile-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 0 20px;
        }
        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
        }
        .profile-avatar-large {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #7C3AED;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 600;
            color: white;
        }
        .profile-header h1 {
            font-size: 32px;
        }
        .profile-card {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            padding: 30px;
            margin-bottom: 20px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }
        .history-item {
            display: flex;
            justify-content: space-between;
            padding: 15px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .history-item:last-child {
            border-bottom: none;
        }
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #7C3AED;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header class="header">
        <div style="display: flex; align-items: center;">
            <div class="logo">StudyAI</div>
            <div class="theme-toggle" id="themeToggle">
                <span class="theme-icon">üåô</span>
            </div>
        </div>
        <nav class="nav-menu">
            <a href="/" class="nav-link">–ù–µ–π—Ä–æ—Å–µ—Ç–∏</a>
            <a href="/shop.html" class="nav-link">–ú–∞–≥–∞–∑–∏–Ω</a>
            <a href="/pricing.html" class="nav-link">–¢–∞—Ä–∏—Ñ—ã</a>
            <a href="/support.html" class="nav-link">–ü–æ–¥–¥–µ—Ä–∂–∫–∞</a>
        </nav>
        <div class="user-menu" id="userMenu"></div>
    </header>

    <main class="profile-container">
        <a href="/" class="back-link">‚Üê –ù–∞ –≥–ª–∞–≤–Ω—É—é</a>
        
        <div id="profileContent">
            <!-- –ö–æ–Ω—Ç–µ–Ω—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
        </div>
    </main>

    <script src="script.js"></script>
    <script>
        firebase.auth().onAuthStateChanged((user) => {
            if (!user) {
                window.location.href = '/';
                return;
            }
            
            const userTokens = JSON.parse(localStorage.getItem('userTokens')) || { balance: 0, purchases: [] };
            const favorites = JSON.parse(localStorage.getItem('favorites')) || [];
            const recentBots = JSON.parse(localStorage.getItem('recentBots')) || [];
            
            document.getElementById('profileContent').innerHTML = `
                <div class="profile-header">
                    <div class="profile-avatar-large">${user.email[0].toUpperCase()}</div>
                    <div>
                        <h1>–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h1>
                        <p style="color: #A0A0A8;">${user.email}</p>
                    </div>
                </div>
                
                <div class="profile-card">
                    <h2 style="margin-bottom: 20px;">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                    <div class="stats-grid">
                        <div style="text-align: center;">
                            <div style="font-size: 36px; font-weight: 700; color: #C084FC;">‚ö° ${userTokens.balance}</div>
                            <div style="color: #A0A0A8;">–¢–æ–∫–µ–Ω–æ–≤</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 36px; font-weight: 700; color: #C084FC;">${favorites.length}</div>
                            <div style="color: #A0A0A8;">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 36px; font-weight: 700; color: #C084FC;">${recentBots.length}</div>
                            <div style="color: #A0A0A8;">–ù–µ–¥–∞–≤–Ω–∏–µ</div>
                        </div>
                    </div>
                </div>
                
                <div class="profile-card">
                    <h2 style="margin-bottom: 20px;">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π</h2>
                    ${userTokens.purchases && userTokens.purchases.length > 0 ? 
                        userTokens.purchases.map(p => `
                            <div class="history-item">
                                <span>‚ûï –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–∞ ${p.amount} —Ç–æ–∫–µ–Ω–æ–≤</span>
                                <span style="color: #A0A0A8;">${new Date(p.date).toLocaleDateString()}</span>
                            </div>
                        `).join('') : 
                        '<p style="color: #71717A; text-align: center;">–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π –ø—É—Å—Ç–∞</p>'
                    }
                </div>
                
                <div style="display: flex; gap: 10px;">
                    <button class="btn-primary" id="goToShop" style="flex: 1;">üõí –ö—É–ø–∏—Ç—å —Ç–æ–∫–µ–Ω—ã</button>
                    <button class="btn-outline" id="logoutBtn" style="flex: 1;">–í—ã–π—Ç–∏</button>
                </div>
            `;
            
            document.getElementById('goToShop').addEventListener('click', () => {
                window.location.href = '/shop.html';
            });
            
            document.getElementById('logoutBtn').addEventListener('click', () => {
                firebase.auth().signOut().then(() => {
                    window.location.href = '/';
                });
            });
        });
    </script>
</body>
</html>